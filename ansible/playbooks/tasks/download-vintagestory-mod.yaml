---
# Download a single Vintage Story mod
# Called via include_tasks with loop
# Variables: mod (the mod entry)

- name: "Download mod: {{ mod.name | default(mod.id) }}"
  get_url:
    url: "https://mods.vintagestory.at/{{ mod.id }}/download/{{ mod.version | default('latest') }}"
    dest: "{{ mods_dir }}/{{ mod.id }}.zip"
    owner: "{{ server_user }}"
    group: "{{ server_user }}"
    mode: "0644"
    force: yes
  register: download_result
  ignore_errors: yes

- name: "Check download result for {{ mod.id }}"
  debug:
    msg: "{{ 'Downloaded' if download_result is success else 'Failed to download' }} {{ mod.id }}"
