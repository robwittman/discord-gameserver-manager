---
# Start LGSM Game Server
#
# Variables:
#   - server_id: Unique server identifier
#   - game_id: Game identifier
#   - lgsm_server_name: LGSM server name

- name: Start LGSM Game Server
  hosts: all
  become: yes
  vars:
    server_user: "gs_{{ server_id | regex_replace('-', '') | truncate(8, True, '') }}"
    server_home: "/opt/gameservers/{{ game_id }}/{{ server_id }}"

  tasks:
    - name: Start game server via LGSM
      become_user: "{{ server_user }}"
      command: "./{{ lgsm_server_name }} start"
      args:
        chdir: "{{ server_home }}"
      register: start_result

    - name: Display start result
      debug:
        msg: "{{ start_result.stdout_lines | default([]) }}"
      when: start_result.stdout_lines is defined
